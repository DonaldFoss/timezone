#!/bin/bash

if [ "$TRAVIS" = "true" ]; then
  (echo -e "\n\n\n" | sudo apt-add-repository ppa:brightbox/ruby-ng-experimental) >/dev/null 2>&1 && echo "brightbox added"
  sudo apt-get -q update >/dev/null 2>&1 && echo "apt-get update" 
  sudo apt-get -q install ruby rubygems ruby-switch >/dev/null 2>&1 && echo "apt-get install ruby rubygems ruby-switch"
  sudo apt-get -q install ruby1.9.3 >/dev/null 2>&1 && echo "apt-get install ruby1.9.3"
  sudo update-alternatives --install /usr/bin/ruby ruby /usr/bin/ruby1.9.3 400 \
                    --slave   /usr/share/man/man1/ruby.1.gz ruby.1.gz \
                                   /usr/share/man/man1/ruby.1.9.3.gz \
                    --slave   /usr/bin/ri ri /usr/bin/ri1.9.3 \
                    --slave   /usr/bin/irb irb /usr/bin/irb1.9.3
  sudo update-alternatives --set ruby /usr/bin/ruby1.9.3
  PATH=/usr/local/gradle/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
  PATH=/usr/local/gradle/bin:/home/vagrant/.nvm/v0.6.15/bin:./node_modules/.bin:$PATH
  PATH=/home/vagrant/builds/bigeasy/timezone/node_modules/.bin:./node_modules/.bin:$PATH
  PATH=/home/vagrant/.nvm/v0.6.15/lib/node_modules/npm/bin/node-gyp-bin:$PATH
  export PATH
  ruby -v
fi

proof t/*/*.t t/locale/*/*.t t/zones/*/*.t || exit 1
