<!DOCTYPE html>  <html> <head>   <title>synopsis.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="doscs/docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               synopsis.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>A walk-though of <strong>Timezone</strong>, a database friendly, timezone aware replacement
for the <code>Date</code> object that implements timezone conversions, timezone aware
date math, timezone and locale aware date formatting, for any date, anywhere
in the world, since the dawn of standardized time.</p>

<p><strong>Timezone</strong> is a JavaScript library with no dependencies. It runs in the
browser and in Node.js.</p>

<p><strong>Timezone</strong> is a micro JavaScript library weight only 3.5k.It is is feature
complete. <strong>Timezone*</strong> is unlikely to get any larger as time goes by.</p>

<p>This walk-through is written for Node.js. You can run this JavaScript program
at the command line like so:</p>

<p><code>
node synopsis.js
</code></p>

<p>You can find a copy where <strong>Timezone</strong> is installed or <a href="https://raw.github.com/bigeasy/timezone/master/synopsis.js">download a
copy</a> from
GitHub.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h3>Functional API</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p><strong>Timezone</strong> is a function. When you import <strong>Timezone</strong>, you probably want
to assign it to a terse variable name. We recommend <code>tz</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ok</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;assert&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">eq</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;assert&quot;</span><span class="p">).</span><span class="nx">equal</span>
  <span class="p">,</span> <span class="nx">tz</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>POSIX Time</h3>

<p><strong>Timezone</strong> replaces the JavaScript <code>Date</code> object with <a href="http://en.wikipedia.org/wiki/Unix_time">POSIX
time</a> &mdash; milliseconds since the
epoch in UTC &mdash; for a cross-platform, internationalized, and durable
representation of a point in time.</p>

<p>POSIX time is absolute. It always represents a time in UTC. It doesn't spring
forward or fall back. It's not affected by the decisions of local
governments or administrators. It is a millisecond in the grand time line.</p>

<p>POSIX time is simple. It is always an integer, making it easy to store in
databases and data stores, even ones little or no support for time stamps.</p>

<p>Because POSIX is an integer, it time is easy to sort and easy to compare.
Sorting and searching POSIX time is fast.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p><em>Timezone returns number representing POSIX time by default.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">y2k</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Unless you provide a format specifier, the return value of a call to the
<strong>Timezone</strong> function will be POSIX time.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p><em>The POSIX time number is always an integer, usually quite large.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">y2k</span><span class="p">,</span> <span class="mi">946684800000</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>The JavaScript <code>Date.UTC</code> function also returns an integer representing POSIX
time. We will use it check our work in our synopsis.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p><em>Did <strong>Timezone</strong> give us the correct POSIX time for 2000?</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">y2k</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>POSIX time is milliseconds since the epoch in UTC. The epoch is New Year's
1970. POSIX time for dates before 1970 are negative. POSIX time for dates
after 1970 are positive.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p><em>The epoch is January 1st, 1970 UTC.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1970-01-01&quot;</span><span class="p">),</span> <span class="mi">0</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p><em>Apollo 11 was before the epoch.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1969-07-21 02:56&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p><em>The first Apollo-Soyuz docking was after the epoch.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1975-07-17 16:19:09&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>POSIX time is durable and portable. Any other language you might use will
have date facilities that convert POSIX time into that language's date
representation.</p>

<p>We use POSIX time to represents and unambiguous point in time, free of
timezone offsets, daylight savings time; all the whimsical manipulations of
local governments. POSIX time is simply an integer, an efficient data type
that easily sorts and compares.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h3>Date Strings</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p><strong>Timezone</strong> uses <a href="http://www.ietf.org/rfc/rfc3339.txt">RFC 3999</a> for date
strings. RFC 3999 is a well-resonsed subset of the meandering ISO 8601
standard. RFC 3999 is the string date format for use in new Internet
protocols going forward. It superceeds the RFC 2822 date format you're
familiar with from HTTP headers.</p>

<p>You've seen us parsing RFC 3999 date strings above. Let's look at a few more
variations.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with a time in seconds.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01T00:00:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>My goodness, that <code>T</code> is silly. It's part of ISO 8601, but RFC 3999 lets us
replace it with a space so it's easier to read. We're not going to use it
again.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with a time in seconds, using the optional space to
replace that silly <code>T</code>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01 00:00:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with just the date, no time.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with the date and a time in minutes.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with the date and a time in seconds.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01 00:00:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with a time zone offset.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1999-12-31 20:00-04:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>We've gone and extended RFC 3999 for two special cases.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>We've added milliseconds.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p><em>Parse an RFC 3999 looking date with the date and a time in milliseconds.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2000-01-01 00:00:00.0&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Back in the day, not recently, there were some localities that specified
their timzeone offset down to the second. Our timezone database goes back to
the 19th century, when these exacting rules were in effect, so we allow
timezone offsets to include seconds.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p><em>Parse an RFC 3999 date with a time zone offset with seconds.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1999-12-31 20:00-04:00:00&quot;</span><span class="p">),</span> <span class="nx">y2k</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>We use RFC 3999 date strings for an easy to type, easy to read, unambiguous
date literal. When we want to type out a date in our code, or store a string
representation in a message header or log file, we use RFC 3999.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <h3>Timezones &mdash; Time O' Clock</h3>

<p>When timezones are in play, we're no longer dealing with POSIX time. We're
dealing with time that has been localized so that it matches the time
according to the clock on the user's wall.</p>

<p>That's why we call it wall-clock time.</p>

<p>Wall-clock time is determined according to the laws of a government or the
rules of an administrative body. Wall-clock time is determined by applying
the timezone offset for the locality, plus any daylight savings offsets
according to these rules.</p>

<p>We don't venture a guess as to what these offsets might be. No. We use the
IANA Timezone Database to convert POSIX time to obtain the best guess
available.</p>

<p>Yes, it's still a guess, because the IANA Database is a product of a lot of
research; leafing through newspapers and government records for talk of clock
changes. However, the IANA Database guess will be right for most cases, and
your guess will be wrong far more often than you'd imagine.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <h3>Converting from Wall-Clock Time</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>We first need to load a timezone rule set from the IANA timezone database.
Let's create a <code>tz</code> function that knows about most of the US timezones.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p><em>Load timezones for all of the Americas.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">us</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/America&quot;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Our new <strong>Timezone</strong> function <code>us</code> knows the rules for a lot of timezones.
Not only timezones in the United States, but also in Canada, Mexico and all
of South America. It won't include Hawaii, however, that's
<code>Pacific/Honolulu</code>. Still, we have pleany of rules to work with to obtain
some wall-clock times.</p>

<p>Our <code>tz</code> function is left unchanged. It doesn't have any timezone rules
loaded.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>If we don't specify a zone name, our new <code>us</code> function will behave just as
old <code>tz</code> function did.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p><em>Time of the moon walk in UTC.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">moonwalk</span> <span class="o">=</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-21 02:56&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p><em>Does</em> <code>Date.UTC</code> <em>agree?</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-21 02:56&quot;</span><span class="p">),</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">1969</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">56</span><span class="p">)</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>However, if we name a zone rule set, we will parse the RFC 3999 date as
wall-clock time, not UTC. Here we use the <code>"America/Detroit"</code> timezone rule
set to parse 10:39 PM wall-clock time the day before the moon walk.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p><em>One small step for [a] man...</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-20 21:56&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>We can parse 7:39 PM in California.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p><em>...one giant leap for mankind.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-20 19:56&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Los_Angeles&quot;</span><span class="p">),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Amsterdam was an hour ahead of UTC at the time of the moon walk. We can't
convert Amsterdam, however, because we didn't load its zone rule set.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p><em>Won't work, didn't load Amsterdam.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-21 03:56&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p><em>Instead of applying Amsterdam's rules, it falls back to UTC.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-21 02:56&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>We can load Amsterdam's rules for just this conversion. Here we both include
the rules for Amsterdam with <code>require</code> and select using the timezone string
<code>"Europe/Amsterdam"</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p><em>Load Amsterdam's rules for just this conversion.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-21 03:56&quot;</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h3>UNIX Date Formats</h3>

<p>When you provide a format string, the <strong>Timezone</strong> function returns a
formatted date string, instead of POSIX time.</p>

<p><strong>Timezone</strong> implements same date format pattern langauge as GNU's version of
the UNIX <code>date</code> utility. <strong>Timezone</strong> supports the full compliment of <a href="http://en.wikipedia.org/wiki/Date_%28Unix%29">GNU
date</a> format specifiers.</p>

<p>This is the same format language used by the UNIX function <code>strftime</code>. You'll
find a version of <code>strftime</code> baked right into C, Ruby, Python, Perl and Lua.
With <strong>Timezone</strong> you can also find a version of <code>strftime</code> in your
JavaScript program.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p><em>Format POSIX time using a GNU date format string.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%m/%d/%Y&quot;</span><span class="p">),</span> <span class="s2">&quot;01/01/2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p><em>You can adjust the padding with padding flags.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-m/%-d/%Y&quot;</span><span class="p">),</span> <span class="s2">&quot;1/1/2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p><em>Two digit year? Yeah, that's right! I don't <strong>learn</strong> lessons.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-m/%-d/%y&quot;</span><span class="p">),</span> <span class="s2">&quot;1/1/00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p><em>Format date and time.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%m/%d/%Y %H:%M:%S&quot;</span><span class="p">),</span> <span class="s2">&quot;07/21/1969 02:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p><em>12 hour clock formats.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%A, %B %-d, %Y %-I:%M:%S %p&quot;</span><span class="p">),</span> <span class="s2">&quot;Monday, July 21, 1969 2:56:00 AM&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p><strong>Timezone</strong> supports all of the GNU <code>date</code> extensions, including some date
calculations you won't find in JavaScript's <code>Date</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p><em>Day of the year.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%j&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;202&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p><em>Day of the week zero-based index starting Sunday.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%w&quot;</span><span class="p">),</span> <span class="s2">&quot;1&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p><em>Day of the week one-based index starting Monday.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%u&quot;</span><span class="p">),</span> <span class="s2">&quot;1&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p><em>Week of the year index week starting Monday.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%W&quot;</span><span class="p">),</span> <span class="s2">&quot;29&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p><em>ISO 8601 <a href="http://en.wikipedia.org/wiki/ISO_8601#Week_dates">week date</a> format.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%G-%V-%wT%T&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-30-1T02:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p><strong>Timezone</strong> is timezone aware so it can print the time zone offset or time
zone abbreviation.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p><em>Get the time zone abbreviation which is * <code>UTC</code> * by default.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%Z&quot;</span><span class="p">),</span> <span class="s2">&quot;UTC&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p><em>Get the time zone offset RFC 822 style.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%z&quot;</span><span class="p">),</span> <span class="s2">&quot;+0000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>When you format a date string and name a zone rule set, the zone format
specifiers show the effect of zone rule set.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p><em>Get the timezone offset abbreviation for Detroit.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;%Z&quot;</span><span class="p">),</span> <span class="s2">&quot;EST&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p><em>Timezone offset RFC 822 style.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;%z&quot;</span><span class="p">),</span> <span class="s2">&quot;-0500&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p><strong>Timezone</strong> supports the GNU extensions to the time zone offset format
specifier <code>%z</code>.  If you put colons between the <code>%</code> and <code>z</code> colons appear in
the time zone offset.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p><em>Timezone offset colon separated.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;%:z&quot;</span><span class="p">),</span> <span class="s2">&quot;-05:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Some time zone rules specify the time zone offset down to the second. None of
the contemporary rules are that precise, but in history of standardized time,
there where some time zone offset sticklers, like the Dutch Railways.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p><em>The time at which the end of the First World War came into effect.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">armistice</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1911-11-11 11:00&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p><em>Timezone offset colon separated, down to the second.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;1969-07-21 03:56&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="s2">&quot;%::z&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;+01:00:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>The <strong>Timezone</strong> function itself offers one extension to <code>strftime</code>, inspired
by the GNU <code>date</code> extensions for <code>%z</code>, to support formatting RFC 3999 date
strings. The format specifier <code>%^z</code> flexibly formats the time zone offset.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p><em>Format UTC as</em> <code>Z</code> <em>instead of</em> <code>+00:00</code> <em>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;Z&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p><em>Timezone offset colon separated, down to the minute.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;-05:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p><em>Timezone offset colon separated, down to the second, only if needed.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">armistice</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="s2">&quot;%^z&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;+00:19:32&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p><em>RFC 3999 string for</em> <code>UTC</code> <em>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-21 02:56:00Z&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p><em>RFC 3999 string not at</em> <code>UTC</code> <em>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-20 21:56:00-05:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p><em>Not part of the RFC 3999 standard, but <strong>Timezone</strong> will parse a time zone
offset specified in seconds.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">armistice</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe/Amsterdam&quot;</span><span class="p">),</span> <span class="s2">&quot;%T %F%^z&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;11:19:32 1911-11-11+00:19:32&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <h4>Padding</h4>

<p><strong>Timezone</strong> implements the GNU padding extensions to <code>strftime</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>For zero padding we use <code>0</code>, but most formats are already zero padded.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p><em>Zero padded day of month, but it is already zero padded.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%B %0d %Y&quot;</span><span class="p">),</span> <span class="s2">&quot;January 01 2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p><em>Same as above.</em>/</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%B %d %Y&quot;</span><span class="p">),</span> <span class="s2">&quot;January 01 2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>To remove padding, add a hyphen after the percent sign.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p><em>With padding.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%m/%d/%Y&quot;</span><span class="p">),</span> <span class="s2">&quot;01/01/2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p><em>Padding stripped.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-m/%-d/%Y&quot;</span><span class="p">),</span> <span class="s2">&quot;1/1/2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>To pad with spaces put an underscore after the percent sign.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p><em>Space padded day of month.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%B %_d %Y&quot;</span><span class="p">),</span> <span class="s2">&quot;January  1 2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p><em>Nanoseconds, silly because we only have millisecond prevision.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;%F %T.%N&quot;</span><span class="p">),</span> <span class="s2">&quot;1970-01-01 00:00:00.001000000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p><em>Milliseconds using a with padding width specifier.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;%F %T.%3N&quot;</span><span class="p">),</span> <span class="s2">&quot;1970-01-01 00:00:00.001&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <h3>Converting to Wall-Clock Time</h3>

<p>To convert to from POSIX time to wall-clock time, we format a date string
specifying the name of a time zone rule set. The <strong>Timezone</strong> function
formats a date string with the time zone rules applied.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>Before you can use a time zone rule set, to create create a <strong>Timezone</strong>
function that contains the rule set.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p><em>Create a <strong>Timezone</strong> function that contains European time zone rules.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">eu</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe&quot;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p>Now we can use the <code>eu</code> <strong>Timezone</strong> function to convert to the wall-clock
time of European localities.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p><em>Convert to wall-clock time in and around Amsterdam.</em>
TK Use armistice.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;1969-07-21 03:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p><em>Convert to wall-clock time in and around Instanbul.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Istanbul&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;1969-07-21 04:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p>Note that wall-clock time is represented as a string. We do not represent
wall-clock time as an integer. Integers are only used to represent POSIX
time.</p>

<p>This allows the <strong>Timezone</strong> to interpret an integer date value unambiguously
as POSIX time, seconds since the epoch in UTC.</p>

<p>We use a string to represent wall-clock time because the time zone offset is
really a display property, because wall-clock time is a display of time.</p>

<p>If feel that you really do need to record wall-clock time, include the
effective time zone offset in the format. That way you will record wall-clock
time and the offset necessary to get to POSIX time.</p>

<p>This is the best format for log files, where string are appropriate, and
wall-clock times are a sometimes nice to have.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p><em>Notice how we're traveling forward in POSIX time but backward in wall-clock
time.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2012-10-28 00:59:59&quot;</span><span class="p">),</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;2012-10-28 02:59:59&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2012-10-28 01:00:00&quot;</span><span class="p">),</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;2012-10-28 02:00:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p><em>With the time zone offset, we can see why the wall-clock time went
backward.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2012-10-28 00:59:59&quot;</span><span class="p">),</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;2012-10-28 02:59:59+02:00&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="s2">&quot;2012-10-28 01:00:00&quot;</span><span class="p">),</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;2012-10-28 02:00:00+01:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>TK Move. Recording the time zone offset rule set name is not very meaningful.
If you need to store location, store a proper address or the latitude and
longitude of the event.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <h3>Converting Between Timezones</h3>

<p>To convert wall-clock time from one time zone to another, we first convert
the wall-clock time of the source time zone to POSIX time. We then convert
from POSIX time to the wall-clock time of the destination time zone.</p>

<p>To do this, we call the <strong>Timezone</strong> function twice.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">posix</span> <span class="o">=</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-20 21:56&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">posix</span><span class="p">,</span> <span class="nx">moonwalk</span> <span class="p">);</span>

<span class="kd">var</span> <span class="nx">wallclock</span> <span class="o">=</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">posix</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">)</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">wallclock</span> <span class="p">,</span> <span class="s2">&quot;1969-07-21 03:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>All at once.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;1969-07-20 21:56&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">),</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span> <span class="p">)</span>
     <span class="p">,</span> <span class="s2">&quot;1969-07-21 03:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>Whenever we parse a date, we are parsing that date in the context of a
timezone. If no timezone is specified, we use the default UTC timezone.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>Thus, specify your starting timezone when you parse. Then specify your target
timezone when you format.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p><em>It's noon in Detroit. What time is it in Warsaw?</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">us</span><span class="p">(</span><span class="s2">&quot;2012-04-01 12:00&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span> <span class="p">),</span> <span class="s2">&quot;Europe/Warsaw&quot;</span><span class="p">,</span> <span class="s2">&quot;%H:%M&quot;</span> <span class="p">),</span> <span class="s2">&quot;18:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>Remember that we can only represent wall-clock time using date strings. POSIX
time is an absolute point in time and has no concept of timezone.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <h3>Locales</h3>

<p>Timezone supports Locales for formatting dates using the GNU Date format
specifiers.</p>

<p>You apply a locale the same way you apply a timezone. You create a <code>tz</code>
function by passing a locale definition into the <code>tz</code> function.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p><em>Add a Polish locale.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">us</span> <span class="o">=</span> <span class="nx">us</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/pl_PL&quot;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p><em>Time of moonwalk in the default Polish date format.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span> <span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span> <span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;nie, 20 lip 1969, 21:56:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p><em>Add a UK, French and German locales.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">eu</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/en_GB&quot;</span><span class="p">)</span>
           <span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/fr_FR&quot;</span><span class="p">)</span>
           <span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/de_DE&quot;</span><span class="p">)</span>
           <span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Europe&quot;</span><span class="p">)</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p><em>Time of moon walk in three European cities.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span> <span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;en_GB&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/London&quot;</span> <span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;Mon 21 Jul 1969 03:56:00 BST&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span> <span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;fr_FR&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Paris&quot;</span> <span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;lun. 21 juil. 1969 03:56:00 CET&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span> <span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;de_DE&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe/Berlin&quot;</span> <span class="p">)</span>
  <span class="p">,</span> <span class="s2">&quot;Mo 21 Jul 1969 03:56:00 CET&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <h3>Date Math</h3>

<p>When <strong>Timezone</strong> performs date math, <strong>Timezone</strong> does so fully aware of
timezone rules. <strong>Timezone</strong> accounts for daylight savings time, leap years
and the occasional changes to timezone offsets.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>With no timezone specified, <strong>Timezone</strong> uses UTC.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>Here are some examples of date math using UTC.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <p><em>Add a millisecond to the epoch.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;+1 millisecond&quot;</span> <span class="p">),</span> <span class="mi">1</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p><em>Travel back in time to the moon walk.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;-30 years&quot;</span><span class="p">,</span> <span class="s2">&quot;-5 months&quot;</span><span class="p">,</span> <span class="s2">&quot;-10 days&quot;</span><span class="p">,</span> <span class="s2">&quot;-21 hours&quot;</span><span class="p">,</span> <span class="s2">&quot;-4 minutes&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">),</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">)</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p><em>Jump to the first Saturday after y2k.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+1 saturday&quot;</span><span class="p">,</span> <span class="s2">&quot;%A %d&quot;</span><span class="p">),</span> <span class="s2">&quot;Saturday 08&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p><em>Jump to the first Saturday after y2k, including y2k.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;-1 day&quot;</span><span class="p">,</span> <span class="s2">&quot;+1 saturday&quot;</span><span class="p">,</span> <span class="s2">&quot;%A %d&quot;</span><span class="p">),</span> <span class="s2">&quot;Saturday 01&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>When a timezone is specified, <strong>Timezone</strong> with adjust the clock for daylight
savings time when moving by hour, minute, second or millisecond.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <p>When moving by day, month, or year with a timezone specified  <strong>Timezone</strong>
will instead adjust the time so that it lands at the same time of day.</p>

<p>This if for whe the user reschedules a six o'clock dinner appointment, from
the day before daylight savings to the day after. They didn't adjust the
appointment by 24 hours, making it a seven o'clock appointment on the first
day of daylight savings. They still want to have dinner at six o'clock; at
six according to the clock on the wall.</p>

<p>Moving across daylight savings time by hour, minute, second or millisecond
will adjust your wall-clock time.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p><em>Moving across daylight savings time by day lands at the same time.</em></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>Moving across daylight savings time by day, month or year will put you at the
same time, you won't spring forward.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <p><em>Moving across daylight savings time by day lands at the same time.</em></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>If you move across daylight savings by hour, you'll see the adjustment for
daylight savings time.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <p>When you land on a time that doesn't exist because of daylight savings time,
timezone scoot past the missing hour.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;2010-03-13 02:30&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;+1 day&quot;</span><span class="p">,</span> <span class="s2">&quot;%c&quot;</span><span class="p">),</span> <span class="s2">&quot;Sun 14 Mar 2010 01:30:00 AM EST&quot;</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <h3>Date Arrays</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <p>The <strong>Timezone</strong> function will also accept an array of integers as a date
input. It will treat this value as wall-clock time and convert it according a
specified time zone rule set.</p>

<p>The date array is useful when working with GUI controls like a series of drop
downs. It is also a good candidate for the output of a date parsing function.
The date array is an easy data structure to populate programatically while
parsing a date string.</p>

<p>The elements <code>0</code> through <code>6</code> of the date array are year, month, date, hour,
minute, second and milliseconds. If you leave an element <code>undefined</code>, it will
be interpreted as zero. The date array must at contain at least a year and a
month, a year alone will interpreted as POSIX time.</p>

<p>Unlike the JavaScript <code>Date</code>, the <strong>Timezone</strong> function does not use a
zero-based month index in an array representation of a date. It uses instead
the humane month number that you'd find if you formatted the date.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-128">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-128">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">picker</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1969</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">56</span> <span class="p">];</span>

<span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">picker</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-129">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-129">&#182;</a>               </div>               <p>The date array format also allows you to specify a time zone offset.</p>

<p>If the element at index <code>7</code> is <code>1</code> or <code>-1</code>, that is treated as the time zone
offset direction, <code>-1</code> for a negative time zone offset, <code>1</code> for a positive
time zone offset. If present, then the elements <code>8</code> through <code>10</code> of the date
array the time zone offset hours, minutes and seconds.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-130">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-130">&#182;</a>               </div>               <p>*A date array with a time zone offset of <code>-05:00</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">([</span> <span class="mi">1969</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]),</span> <span class="nx">moonwalk</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-131">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-131">&#182;</a>               </div>               <h3>Creating Partials</h3>

<p>If you call <code>tz</code> without a date parameter, <code>tz</code> will create a new function
that is a <a href="http://ejohn.org/blog/partial-functions-in-javascript/">partial
application</a> of the
<code>tz</code> function. This is how we load timezones and locales.</p>

<p>We can also use this to create custom functions that are specialized with
<code>tz</code> parameters. This can help use reduce noise in our code, if we are
invoking <code>tz</code> with the same set of parameters over and over again.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-132">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-132">&#182;</a>               </div>               <p><em>We've been using parital functions to load time zones and locales.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">us</span> <span class="o">=</span> <span class="nx">us</span><span class="p">(</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/pl_PL&quot;</span><span class="p">)</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-133">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-133">&#182;</a>               </div>               <p><em>Format a week of days after Y2K.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+1 day&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;sobota&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">us</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+2 days&quot;</span><span class="p">,</span> <span class="s2">&quot;America/Detroit&quot;</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;niedziela&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-134">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-134">&#182;</a>               </div>               <p><em>Reduce the noise by creating a partial with the timezone.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">detroit</span> <span class="o">=</span> <span class="nx">us</span><span class="p">(</span><span class="s2">&quot;America/Detroit&quot;</span><span class="p">);</span>

<span class="nx">eq</span><span class="p">(</span> <span class="nx">detroit</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+3 days&quot;</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;poniedziałek&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">detroit</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+4 days&quot;</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;wtorek&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-135">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-135">&#182;</a>               </div>               <p><em>Let's get rid of more chatter by creating a partial with the locale.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">hamtramck</span> <span class="o">=</span> <span class="nx">detroit</span><span class="p">(</span><span class="s2">&quot;pl_PL&quot;</span><span class="p">);</span>

<span class="nx">eq</span><span class="p">(</span> <span class="nx">hamtramck</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+5 days&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;środa&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">hamtramck</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+6 days&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;czwartek&quot;</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">hamtramck</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;+7 days&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;piątek&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-136">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-136">&#182;</a>               </div>               <h3>Initialization</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-137">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-137">&#182;</a>               </div>               <p>Locales and time zones are defined by rules, locale rules and time zone
rules. Locales and time zones are specified by a name, either a locale string
in the form of <code>en_US</code>, or a time zone string in the form of
<code>America/Detroit</code>.</p>

<p>In order to apply either a locale or a time zone rule set, you must provide
the <strong>Timezone</strong> function with both the rule data and the rule name.</p>

<p>Rather than providing both arguments each time, you'll generally want to
load a number of rule sets into a partial application funcition. We've done
this a number of times already in our walk-though.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-138">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-138">&#182;</a>               </div>               <p><em>Doesn't know anything about <code>Asia/Tashkent</code>, defaults to UTC.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;Asia/Tashkent&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-21 02:56:00Z&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-139">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-139">&#182;</a>               </div>               <p><em>Load all of the timezone data for Asia.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">asia</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Asia&quot;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-140">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-140">&#182;</a>               </div>               <p><em>Now <code>Asia/Tashkent</code> is available to the our <code>asia</code> function.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">asia</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;Asia/Tashkent&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-21 08:56:00+06:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-141">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-141">&#182;</a>               </div>               <p>If you later need more timezone data, you can add it using your existing
partial function.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-142">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-142">&#182;</a>               </div>               <p><em>Add the Pacific Islands to Asia.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">asia</span> <span class="o">=</span> <span class="nx">asia</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Pacific&quot;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-143">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-143">&#182;</a>               </div>               <p><em>Now we have Hawaii.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">asia</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;Pacific/Honolulu&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-20 16:56:00-10:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-144">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-144">&#182;</a>               </div>               <p>Note that you can provide the rule data and the rule name at the same time.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-145">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-145">&#182;</a>               </div>               <p><em>Load Asia and select Tashkent in one call.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/Asia&quot;</span><span class="p">),</span> <span class="s2">&quot;Asia/Tashkent&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T%^z&quot;</span><span class="p">),</span> <span class="s2">&quot;1969-07-21 08:56:00+06:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-146">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-146">&#182;</a>               </div>               <p>It is generally preferable to create a partial function that loads the data
you need, however.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-147">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-147">&#182;</a>               </div>               <p>Locales are loaded in the same fashion.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-148">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-148">&#182;</a>               </div>               <p><em>Knows nothing of Polish, defaults to <code>en_US</code>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;Monday&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-149">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-149">&#182;</a>               </div>               <p><em>Create a Polish aware partial function.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">pl</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;timezone/pl_PL&quot;</span><span class="p">));</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">pl</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;pl_PL&quot;</span><span class="p">,</span> <span class="s2">&quot;%A&quot;</span><span class="p">),</span> <span class="s2">&quot;poniedziałek&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-150">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-150">&#182;</a>               </div>               <h3>Functional Composition</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-151">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-151">&#182;</a>               </div>               <p><strong>Timezone</strong> implements a set of standards and de facto standards.
<strong>Timezone</strong> is not extensible. Quite the opposite. <strong>Timezone</strong> is sealed.</p>

<p><strong>Timezone</strong> focuses on getting wall-clock time right. It supports a robust,
timezone aware formatting language, and it it parses an Internet standard
date string. With all the unit tests in place, there is little reason for
<strong>Timezone</strong> to add new features, so you can count on its size to be small,
under 3k, for the foreseeable future.</p>

<p>Most importantly, <strong>Timezone</strong> avoids the mistake of treating a date
formatting and date parsing as two sides of the same coin. Much in the same
way that generating web pages from a database, like a blog, is not as simple
as generating a database from web pages, like a search engine.</p>

<p>That's not to say that date parsing is as complicated as a search engine,
just that it is generally application specific, requires a lot of context,
and it is not proportionate in complexity to date formatting, date math or time
zone offset lookup. We might be able to hide a lot of the bulk in data files
that accompany our library, but we would so</p>

<p>Rather than opening up <strong>Timezone</strong> to extend it, we build on top of it,
through functional composition. <strong>Timezone</strong> is a function in a functional
language. It is configurable and easy to pass around.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-152">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-152">&#182;</a>               </div>               <h4>Ordinal Numbers</h4>

<p>You want to print the date as a ordinal number.</p>

<p>Create a function that convert a number to an ordinal number, then write a
regular expression to match numbers in your format string that you want to
ordinalize.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-153">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-153">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">ordinal</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">nth</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">100</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">nth</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="nx">nth</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">)</span> <span class="k">return</span> <span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;th&quot;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">date</span> <span class="o">+</span> <span class="p">([</span> <span class="s2">&quot;st&quot;</span><span class="p">,</span> <span class="s2">&quot;nd&quot;</span><span class="p">,</span> <span class="s2">&quot;rd&quot;</span> <span class="p">][(</span><span class="nx">nth</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">ok</span><span class="p">(</span> <span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%B %-d, %Y&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\d+/</span><span class="p">,</span> <span class="nx">ordinal</span><span class="p">),</span> <span class="s2">&quot;January 1st, 2000&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-154">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-154">&#182;</a>               </div>               <h4>Plucking Date Fields</h4>

<p>The original <code>Date</code> object is missing a lot of functionality, but includes a
lot of getters and setters. I think they're silly and that's why <strong>Timezone</strong>
is a function and not an object. Because time is not object-oriented.</p>

<p>However, you do find that you need to get properties as integers, just use
date format and make an easy conversion to integer.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-155">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-155">&#182;</a>               </div>               <p><em>Get the year as integer.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="o">+</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%Y&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">y2k</span><span class="p">).</span><span class="nx">getUTCFullYear</span><span class="p">()</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-156">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-156">&#182;</a>               </div>               <p><em>Careful to strip leading zeros so it doesn't become octal.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="o">+</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-d&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">y2k</span><span class="p">).</span><span class="nx">getUTCDate</span><span class="p">()</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-157">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-157">&#182;</a>               </div>               <p><em>January is one.</em>/</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="o">+</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-m&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">y2k</span><span class="p">).</span><span class="nx">getUTCMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-158">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-158">&#182;</a>               </div>               <p><em>Here's your date of week.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">y2k</span><span class="p">,</span> <span class="s2">&quot;%-w&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">y2k</span><span class="p">).</span><span class="nx">getUTCDay</span><span class="p">()</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-159">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-159">&#182;</a>               </div>               <p>Plus there are a few properties you can get that are not available to date.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-160">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-160">&#182;</a>               </div>               <p><em>Here's your date of week starting Monday.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="o">+</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%-V&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="mi">30</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-161">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-161">&#182;</a>               </div>               <p><em>Day of the year.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ok</span><span class="p">(</span> <span class="o">+</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%-j&quot;</span><span class="p">))</span> <span class="o">===</span> <span class="mi">202</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-162">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-162">&#182;</a>               </div>               <h4>Arrays of Date Fields</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-163">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-163">&#182;</a>               </div>               <p>What if you want the integer value of a number of different fields?</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-164">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-164">&#182;</a>               </div>               <p><em>Split a string into words and convert the words to integers.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">array</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">date</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="nx">array</span><span class="p">(</span><span class="nx">tz</span><span class="p">(</span><span class="nx">moonwalk</span><span class="p">,</span> <span class="s2">&quot;%Y %m %d %H %M %S&quot;</span><span class="p">));</span>

<span class="nx">eq</span><span class="p">(</span> <span class="nx">date</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1969</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">date</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">7</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">date</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">21</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">date</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span> <span class="p">);</span>
<span class="nx">eq</span><span class="p">(</span> <span class="nx">date</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">56</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-165">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-165">&#182;</a>               </div>               <h4>Additional Date Parsers</h4>

<p>Create a function that returns our date array format.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-166">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-166">&#182;</a>               </div>               <h4>Timezones in Date Strings</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-167">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-167">&#182;</a>               </div>               <p>GNU <code>date</code> has a nice feature where you can specify the timezone of a date
string using <code>TZ</code> like so <code>'TZ="America/Detroit" 1999-12-01 20:00'</code>. This
allows you to store a string with a timezone.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-168">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-168">&#182;</a>               </div>               <p><em>Extract a specified timezone from a date string.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">tzdate</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">match</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">match</span> <span class="o">=</span> <span class="sr">/^TZ=&quot;(\S+)&quot;\s+(.*)$/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">date</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">match</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="nx">reverse</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-169">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-169">&#182;</a>               </div>               <p><em>Parse a date with a date string. First one wins.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">eu</span><span class="p">(</span><span class="nx">tzdate</span><span class="p">(</span><span class="s1">&#39;TZ=&quot;Europe/Istanbul&quot; 2012-02-29 04:00&#39;</span><span class="p">)),</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">),</span> <span class="s2">&quot;2012-02-29 03:00:00&quot;</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-170">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-170">&#182;</a>               </div>               <p><em>Parse a date without a date string, defaults to UTC.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">eq</span><span class="p">(</span> <span class="nx">eu</span><span class="p">(</span><span class="nx">eu</span><span class="p">(</span><span class="s2">&quot;2012-02-29 04:00&quot;</span><span class="p">),</span> <span class="s2">&quot;Europe/Amsterdam&quot;</span><span class="p">,</span> <span class="s2">&quot;%F %T&quot;</span><span class="p">),</span> <span class="s2">&quot;2012-02-29 05:00:00&quot;</span> <span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> 

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-20388260-3', 'bigeasy.github.io');
  ga('send', 'pageview');
</script>

</body>
</html>
